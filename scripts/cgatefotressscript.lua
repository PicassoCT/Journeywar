

include "lib_OS.lua"
include "lib_UnitScript.lua"
include "lib_Build.lua" 

  TableOfPieces={}
  center = piece("center")
 TableOfPieces[#TableOfPieces+1]= center
  Erker4 = piece("Erker4")
 TableOfPieces[#TableOfPieces+1]= Erker4
  InnerLoop10 = piece("InnerLoop10")
 TableOfPieces[#TableOfPieces+1]= InnerLoop10
  InnerLoop1 = piece("InnerLoop1")
 TableOfPieces[#TableOfPieces+1]= InnerLoop1
  InnerLoop2 = piece("InnerLoop2")
 TableOfPieces[#TableOfPieces+1]= InnerLoop2
  InnerLoop3 = piece("InnerLoop3")
 TableOfPieces[#TableOfPieces+1]= InnerLoop3
  InnerLoop4 = piece("InnerLoop4")
 TableOfPieces[#TableOfPieces+1]= InnerLoop4
  InnerLoop5 = piece("InnerLoop5")
 TableOfPieces[#TableOfPieces+1]= InnerLoop5
  InnerLoop6 = piece("InnerLoop6")
 TableOfPieces[#TableOfPieces+1]= InnerLoop6
  InnerLoop7 = piece("InnerLoop7")
 TableOfPieces[#TableOfPieces+1]= InnerLoop7
  InnerLoop8 = piece("InnerLoop8")
 TableOfPieces[#TableOfPieces+1]= InnerLoop8
  InnerLoop9 = piece("InnerLoop9")
 TableOfPieces[#TableOfPieces+1]= InnerLoop9
  InnerLoopC = piece("InnerLoopC")
 TableOfPieces[#TableOfPieces+1]= InnerLoopC
  NGon085 = piece("NGon085")
 TableOfPieces[#TableOfPieces+1]= NGon085
  NGon086 = piece("NGon086")
 TableOfPieces[#TableOfPieces+1]= NGon086
  NGon089 = piece("NGon089")
 TableOfPieces[#TableOfPieces+1]= NGon089
  NGon090 = piece("NGon090")
 TableOfPieces[#TableOfPieces+1]= NGon090
  NGon088 = piece("NGon088")
 TableOfPieces[#TableOfPieces+1]= NGon088
  Gun3 = piece("Gun3")
 TableOfPieces[#TableOfPieces+1]= Gun3
  Mag5 = piece("Mag5")
 TableOfPieces[#TableOfPieces+1]= Mag5
  Mag6 = piece("Mag6")
 TableOfPieces[#TableOfPieces+1]= Mag6
  Erker3 = piece("Erker3")
 TableOfPieces[#TableOfPieces+1]= Erker3
  Erker2 = piece("Erker2")
 TableOfPieces[#TableOfPieces+1]= Erker2
  NGon087 = piece("NGon087")
 TableOfPieces[#TableOfPieces+1]= NGon087
  InnerOrigin = piece("InnerOrigin")
 TableOfPieces[#TableOfPieces+1]= InnerOrigin
  OuterLoop12 = piece("OuterLoop12")
 TableOfPieces[#TableOfPieces+1]= OuterLoop12
  OuterLoop24 = piece("OuterLoop24")
 TableOfPieces[#TableOfPieces+1]= OuterLoop24
  OuterLoop27 = piece("OuterLoop27")
 TableOfPieces[#TableOfPieces+1]= OuterLoop27
  Gun1 = piece("Gun1")
 TableOfPieces[#TableOfPieces+1]= Gun1
  Mag1 = piece("Mag1")
 TableOfPieces[#TableOfPieces+1]= Mag1
  Mag2 = piece("Mag2")
 TableOfPieces[#TableOfPieces+1]= Mag2
  OuterLoop25 = piece("OuterLoop25")
 TableOfPieces[#TableOfPieces+1]= OuterLoop25
  OuterLoop29 = piece("OuterLoop29")
 TableOfPieces[#TableOfPieces+1]= OuterLoop29
  Gun4 = piece("Gun4")
 TableOfPieces[#TableOfPieces+1]= Gun4
  Mag7 = piece("Mag7")
 TableOfPieces[#TableOfPieces+1]= Mag7
  Mag8 = piece("Mag8")
 TableOfPieces[#TableOfPieces+1]= Mag8
  OuterLoop30 = piece("OuterLoop30")
 TableOfPieces[#TableOfPieces+1]= OuterLoop30
  OuterLoop31 = piece("OuterLoop31")
 TableOfPieces[#TableOfPieces+1]= OuterLoop31
  OuterLoop32 = piece("OuterLoop32")
 TableOfPieces[#TableOfPieces+1]= OuterLoop32
  OuterLoop35 = piece("OuterLoop35")
 TableOfPieces[#TableOfPieces+1]= OuterLoop35
  OuterLoop36 = piece("OuterLoop36")
 TableOfPieces[#TableOfPieces+1]= OuterLoop36
  OuterLoop37 = piece("OuterLoop37")
 TableOfPieces[#TableOfPieces+1]= OuterLoop37
  OuterLoop38 = piece("OuterLoop38")
 TableOfPieces[#TableOfPieces+1]= OuterLoop38
  OuterLoop39 = piece("OuterLoop39")
 TableOfPieces[#TableOfPieces+1]= OuterLoop39
  Erker5 = piece("Erker5")
 TableOfPieces[#TableOfPieces+1]= Erker5
  Erker6 = piece("Erker6")
 TableOfPieces[#TableOfPieces+1]= Erker6
  OuterLoop34 = piece("OuterLoop34")
 TableOfPieces[#TableOfPieces+1]= OuterLoop34
  OuterLoop40 = piece("OuterLoop40")
 TableOfPieces[#TableOfPieces+1]= OuterLoop40
  OuterLoop41 = piece("OuterLoop41")
 TableOfPieces[#TableOfPieces+1]= OuterLoop41
  OuterLoop43 = piece("OuterLoop43")
 TableOfPieces[#TableOfPieces+1]= OuterLoop43
  RailGun = piece("RailGun")
 TableOfPieces[#TableOfPieces+1]= RailGun
  Projectile = piece("Projectile")
 TableOfPieces[#TableOfPieces+1]= Projectile
  DronePod1 = piece("DronePod1")
 TableOfPieces[#TableOfPieces+1]= DronePod1
  DronePod2 = piece("DronePod2")
 TableOfPieces[#TableOfPieces+1]= DronePod2
  OuterLoop33 = piece("OuterLoop33")
 TableOfPieces[#TableOfPieces+1]= OuterLoop33
  OuterLoop42 = piece("OuterLoop42")
 TableOfPieces[#TableOfPieces+1]= OuterLoop42
  OuterLoop44 = piece("OuterLoop44")
 TableOfPieces[#TableOfPieces+1]= OuterLoop44
  OuterLoop47 = piece("OuterLoop47")
 TableOfPieces[#TableOfPieces+1]= OuterLoop47
  OuterLoop55 = piece("OuterLoop55")
 TableOfPieces[#TableOfPieces+1]= OuterLoop55
  Erker9 = piece("Erker9")
 TableOfPieces[#TableOfPieces+1]= Erker9
  Erker10 = piece("Erker10")
 TableOfPieces[#TableOfPieces+1]= Erker10
  OuterLoop54 = piece("OuterLoop54")
 TableOfPieces[#TableOfPieces+1]= OuterLoop54
  DronePod3 = piece("DronePod3")
 TableOfPieces[#TableOfPieces+1]= DronePod3
  Erker11 = piece("Erker11")
 TableOfPieces[#TableOfPieces+1]= Erker11
  OuterLoop50 = piece("OuterLoop50")
 TableOfPieces[#TableOfPieces+1]= OuterLoop50
  OuterLoop51 = piece("OuterLoop51")
 TableOfPieces[#TableOfPieces+1]= OuterLoop51
  DronePod4 = piece("DronePod4")
 TableOfPieces[#TableOfPieces+1]= DronePod4
  OuterLoop45 = piece("OuterLoop45")
 TableOfPieces[#TableOfPieces+1]= OuterLoop45
  OuterLoop46 = piece("OuterLoop46")
 TableOfPieces[#TableOfPieces+1]= OuterLoop46
  OuterLoop53 = piece("OuterLoop53")
 TableOfPieces[#TableOfPieces+1]= OuterLoop53
  OuterLoop52 = piece("OuterLoop52")
 TableOfPieces[#TableOfPieces+1]= OuterLoop52
  Erker1 = piece("Erker1")
 TableOfPieces[#TableOfPieces+1]= Erker1
  Erker8 = piece("Erker8")
 TableOfPieces[#TableOfPieces+1]= Erker8
  OuterLoop48 = piece("OuterLoop48")
 TableOfPieces[#TableOfPieces+1]= OuterLoop48
  OuterLoop49 = piece("OuterLoop49")
 TableOfPieces[#TableOfPieces+1]= OuterLoop49
  Erker7 = piece("Erker7")
 TableOfPieces[#TableOfPieces+1]= Erker7
  DronePod5 = piece("DronePod5")
 TableOfPieces[#TableOfPieces+1]= DronePod5
  Wall = piece("Wall")
 TableOfPieces[#TableOfPieces+1]= Wall
  GatePoint = piece("GatePoint")
 TableOfPieces[#TableOfPieces+1]= GatePoint
  RingB = piece("RingB")
 TableOfPieces[#TableOfPieces+1]= RingB
  Ring0 = piece("Ring0")
 TableOfPieces[#TableOfPieces+1]= Ring0
  GatePortal = piece("GatePortal")
 TableOfPieces[#TableOfPieces+1]= GatePortal
  GateWave = piece("GateWave")
 TableOfPieces[#TableOfPieces+1]= GateWave
  WaveA = piece("WaveA")
 TableOfPieces[#TableOfPieces+1]= WaveA
  Feed10 = piece("Feed10")
 TableOfPieces[#TableOfPieces+1]= Feed10
  Feed9 = piece("Feed9")
 TableOfPieces[#TableOfPieces+1]= Feed9
  Feed8 = piece("Feed8")
 TableOfPieces[#TableOfPieces+1]= Feed8
  Feed7 = piece("Feed7")
 TableOfPieces[#TableOfPieces+1]= Feed7
  Feed6 = piece("Feed6")
 TableOfPieces[#TableOfPieces+1]= Feed6
  Feed5 = piece("Feed5")
 TableOfPieces[#TableOfPieces+1]= Feed5
  Feed4 = piece("Feed4")
 TableOfPieces[#TableOfPieces+1]= Feed4
  Feed3 = piece("Feed3")
 TableOfPieces[#TableOfPieces+1]= Feed3
  Feed2 = piece("Feed2")
 TableOfPieces[#TableOfPieces+1]= Feed2
  Feed1 = piece("Feed1")
 TableOfPieces[#TableOfPieces+1]= Feed1
  Ring3 = piece("Ring3")
 TableOfPieces[#TableOfPieces+1]= Ring3
  Ring2 = piece("Ring2")
 TableOfPieces[#TableOfPieces+1]= Ring2
  Ring1 = piece("Ring1")
 TableOfPieces[#TableOfPieces+1]= Ring1
  BigLUpCenter = piece("BigLUpCenter")
 TableOfPieces[#TableOfPieces+1]= BigLUpCenter
  OuterLoop13 = piece("OuterLoop13")
 TableOfPieces[#TableOfPieces+1]= OuterLoop13
  OuterLoop14 = piece("OuterLoop14")
 TableOfPieces[#TableOfPieces+1]= OuterLoop14
  OuterLoop15 = piece("OuterLoop15")
 TableOfPieces[#TableOfPieces+1]= OuterLoop15
  OuterLoop16 = piece("OuterLoop16")
 TableOfPieces[#TableOfPieces+1]= OuterLoop16
  OuterLoop17 = piece("OuterLoop17")
 TableOfPieces[#TableOfPieces+1]= OuterLoop17
  OuterLoop18 = piece("OuterLoop18")
 TableOfPieces[#TableOfPieces+1]= OuterLoop18
  OuterLoop19 = piece("OuterLoop19")
 TableOfPieces[#TableOfPieces+1]= OuterLoop19
  OuterLoop20 = piece("OuterLoop20")
 TableOfPieces[#TableOfPieces+1]= OuterLoop20
  OuterLoop21 = piece("OuterLoop21")
 TableOfPieces[#TableOfPieces+1]= OuterLoop21
  OuterLoop22 = piece("OuterLoop22")
 TableOfPieces[#TableOfPieces+1]= OuterLoop22
  OuterLoop23 = piece("OuterLoop23")
 TableOfPieces[#TableOfPieces+1]= OuterLoop23

  BigLCenter = piece("BigLCenter")
 TableOfPieces[#TableOfPieces+1]= BigLCenter
  OuterLoop10 = piece("OuterLoop10")
 TableOfPieces[#TableOfPieces+1]= OuterLoop10
  OuterLoop11 = piece("OuterLoop11")
 TableOfPieces[#TableOfPieces+1]= OuterLoop11

  UpGo1 = piece("UpGo1")
 TableOfPieces[#TableOfPieces+1]= UpGo1    
 UpGo2 = piece("UpGo2")
 TableOfPieces[#TableOfPieces+1]= UpGo2  
 
 OuterLoop1 = piece("OuterLoop1")
 TableOfPieces[#TableOfPieces+1]= OuterLoop1 
 
 OuterLoop56 = piece("OuterLoop56")
 TableOfPieces[#TableOfPieces+1]= OuterLoop56
  OuterLoop26 = piece("OuterLoop26")
 TableOfPieces[#TableOfPieces+1]= OuterLoop26
  OuterLoop28 = piece("OuterLoop28")
 TableOfPieces[#TableOfPieces+1]= OuterLoop28
  Gun2 = piece("Gun2")
 TableOfPieces[#TableOfPieces+1]= Gun2
  Mag3 = piece("Mag3")
 TableOfPieces[#TableOfPieces+1]= Mag3
  Mag4 = piece("Mag4")
 TableOfPieces[#TableOfPieces+1]= Mag4
  OuterLoop2 = piece("OuterLoop2")
 TableOfPieces[#TableOfPieces+1]= OuterLoop2
  OuterLoop3 = piece("OuterLoop3")
 TableOfPieces[#TableOfPieces+1]= OuterLoop3
  OuterLoop4 = piece("OuterLoop4")
 TableOfPieces[#TableOfPieces+1]= OuterLoop4
  OuterLoop5 = piece("OuterLoop5")
 TableOfPieces[#TableOfPieces+1]= OuterLoop5
  OuterLoop6 = piece("OuterLoop6")
 TableOfPieces[#TableOfPieces+1]= OuterLoop6
  OuterLoop7 = piece("OuterLoop7")
 TableOfPieces[#TableOfPieces+1]= OuterLoop7
  OuterLoop8 = piece("OuterLoop8")
 TableOfPieces[#TableOfPieces+1]= OuterLoop8
  OuterLoop9 = piece("OuterLoop9")
 TableOfPieces[#TableOfPieces+1]= OuterLoop9
  CatapultRoto1 = piece("CatapultRoto1")
 TableOfPieces[#TableOfPieces+1]= CatapultRoto1
  CataLow1 = piece("CataLow1")
 TableOfPieces[#TableOfPieces+1]= CataLow1
  CataUp1 = piece("CataUp1")
 TableOfPieces[#TableOfPieces+1]= CataUp1
  CataHead1 = piece("CataHead1")
 TableOfPieces[#TableOfPieces+1]= CataHead1
  CatapultRoto2 = piece("CatapultRoto2")
 TableOfPieces[#TableOfPieces+1]= CatapultRoto2
  CataLow2 = piece("CataLow2")
 TableOfPieces[#TableOfPieces+1]= CataLow2
  CataUp2 = piece("CataUp2")
 TableOfPieces[#TableOfPieces+1]= CataUp2
  CataHead2 = piece("CataHead2")
 TableOfPieces[#TableOfPieces+1]= CataHead2
  InLoopCenter = piece("InnerLoopC")
 TableOfPieces[#TableOfPieces+1]= InLoopCenter


TablesOfPiecesGroups={}--=makePiecesTablesByNameGroups(false,true)

Feed={}
OuterLoopTable={}
OuterLoopTable={}
Mag={}
Ring={}
InnerLoop={}

--Constants
feed_speed=53
GateDeg=-15
LengthFeed=53
FeedTime=1.1666666666666
InnerLoopRadius=82

function script.HitByWeapon ( x, z, weaponDefID, damage ) 

end

function script.Create()
TablesOfPiecesGroups=makePiecesTablesByNameGroups(false,true)
Feed=TablesOfPiecesGroups["Feed"]

OuterLoopTable=TablesOfPiecesGroups["OuterLoop"]
Mag=TablesOfPiecesGroups["Mag"]
Ring=TablesOfPiecesGroups["Ring"]
InnerLoop=TablesOfPiecesGroups["InnerLoop"]


	for i=1,#Mag do
	Sign=i%2
	if Sign==0 then Sign=-1 end
		Spin(Mag[i],x_axis,math.rad(42*Sign),0)
	end
x,y,z=Spring.GetUnitPiecePosDir(unitID,RingB)

hideT(TableOfPieces)
--generatepiecesTableAndArrayCode(unitID)
StartThread(AnimTest)
end

function script.Killed(recentDamage,_)
	return 1
end


----aimining & fire weapon
function script.AimFromWeapon1() 
	return center 
end



function script.QueryWeapon1() 
	return center
end

function script.AimWeapon1( Heading ,pitch)	
	--aiming animation: instantly turn the gun towards the enemy

	return boolOneShot

end

function AnimTest()
	while true do 
		unfoldAnimation()
		Sleep(1000)
		foldAnimation()
	end

end
  
 local PI=3.1415926535897932384626433832795
 local SignalTable={}
function unfoldAnimation()
reseT(TableOfPieces)
hideT(TableOfPieces)
Sleep(10)
Spring.Echo("UnfoldAnimation")
n=1
n=	GateDeploy(n,true)	
	StartThread(GateLoop,n,true)

n=	FirstTrainDeploy(n,true)	
	StartThread(TrainLoop,n,true)

n=	InnerCircleDeploy(n,true)	
	StartThread(InnerCircleLoop,n,true)

n=	OuterCircleDeploy(n,true)	

	StartThread(GoUp,n,true,2*PI*0.08333333333333333333 *(1/1.1666 ))
	StartThread(OuterCircleLoop,n,true)

n=	UpperCircleDeploy(n,true)
	StartThread(UpperCircleLoop,n,true)
stopScript("cgatefotressscript")
n=	TowerDeploy(n,true)
n=	OutPostDeploy(n,true)
n=	InnerCityDeploy(n,true)
n=	RailGunUnfold(n,true)
n=	CityBlocksDeploy(n,true)	



end

function foldAnimation()
Sleep(10)
Spring.Echo("Fold Animation")
testPiece=piece("center")
Spring.Echo(testPiece)
--	CityBlocksDeploy	
--	RailGunUnfold
--	InnerCityDeploy
--	OutPostDeploy
--	TowerDeploy
--	UpperCircleDeploy

--OuterCircleLoop
	--OuterCircleDeploy
--InnerCircleLoop
	--InnerCircleDeploy
--GateLoop
	--GateDeploy
--TrainLoop
	--FirstTrainDeploy
	

hideT(TableOfPieces)
end

boolOnTheMove=false 
boolOneShot=true 
teamid=Spring.GetUnitTeam(unitID)

function script.FireWeapon1()	
boolOneShot=false
makeCascadingTables("GG.FiringGateFotressTable["..teamid.."["..unitID.."]]",true)
StartThread(watchForImpact)
	return true
end



function GateDeploy (SignalNumber,boolReverse) 
	boolDirection= false 
	if boolReverse then boolDirection =boolReverse end
	--if the animation should be aborted, we revert it 
	if SignalTable[SignalNumber]==false then boolDirection=true end
		if boolDirection==true then
		Turn(GatePoint,y_axis,math.rad(GateDeg),9)
		--Preparation
		Move(center,y_axis,2.5,0)
		Move(Ring0,y_axis,-15,0)
		Turn(Ring0,y_axis,math.rad(-90),0)
		Show(Ring0)
		Show(RingB)
		Turn(Ring0,y_axis,math.rad(0),1.2)
			moveExpPiece(Ring0,y_axis,15,-15,5,750,15,false)
		Move(Ring0,y_axis,0,35)
		WaitForMove(Ring0,y_axis)
		Turn(Ring3,x_axis,math.rad(180+46),0)
		Turn(Ring2,x_axis,math.rad(180+2*46),0)
		Turn(Ring1,x_axis,math.rad(180+3*46),0)
		WaitForTurn(Ring3,x_axis)
		WaitForTurn(Ring2,x_axis)
		WaitForTurn(Ring1,x_axis)
		Turn(Ring1,x_axis,math.rad(0),10)				
			Show(Ring1)
		WaitForTurn(Ring1,x_axis)
		Turn(Ring2,x_axis,math.rad(0),10)
			Show(Ring2)
		WaitForTurn(Ring2,x_axis)
		Turn(Ring3,x_axis,math.rad(0),10)
			Show(Ring3)
		WaitForTurn(Ring3,x_axis)
			Show(GatePortal)
		Spin(GatePortal,x_axis,math.rad(42),0)

		else


		 
		end 
	return SignalNumber+1 
 end
 
function GateLoop (SignalNumber,boolReverse) 
AlterRate=0
SignalTable[SignalNumber]=true
	while SignalTable[SignalNumber]==true do
AlterRate=AlterRate+1
				Spin(GateWave,x_axis,math.rad(42),0)
				Spin(WaveA,x_axis,math.rad(42),0)
				Show(GateWave)
				Show(WaveA)
				speed=math.random(1.5,4)
				if maRo() then
					
					if AlterRate % 2==1 then
						Move(GateWave,x_axis,-5.5,speed)
					end
					
					if AlterRate % 2==0 then
						Move(WaveA,x_axis,-3.14,speed)
					end
				end
				
				
				WaitForMove(WaveA,x_axis)
				WaitForMove(GateWave,x_axis)
				Move(WaveA,x_axis,0,speed)
				Move(GateWave,x_axis,0,speed)
				WaitForMove(WaveA,x_axis)
				WaitForMove(GateWave,x_axis)
				
		
	Sleep(10)
	end
--HoldPosition
return SignalNumber+1 
 end
 
function FirstTrainDeploy (SignalNumber,boolReverse) 
 	boolDirection= false 
	if boolReverse then boolDirection =boolReverse end
	--if the animation should be aborted, we revert it 
	if SignalTable[SignalNumber]==false then boolDirection=true end

		if boolDirection==true then
		
		WMove(Feed10,x_axis,0,0)
		count_up=0
			
			for i=0,-LengthFeed,-4.8 do
			WMove(Feed10,x_axis,i,feed_speed)
			if 	 Feed[count_up] then			
					Show(Feed[count_up])
			end
			count_up=math.min(count_up+1,9)
			end
			Show(Feed10)
			hideT(Feed)
		else


		 
		end 
 return SignalNumber+1 
 end
	function TrainLoop (SignalNumber,boolReverse) 
	 	boolDirection= false ; 	if boolReverse then boolDirection =boolReverse end
		SignalTable[SignalNumber]=true
		
 	while SignalTable[SignalNumber]==true do
		if boolDirection==true then
		
		WMove(Feed10,x_axis,0,0)
		count_up=0
		starttime=Spring.GetGameFrame()
			for i=0,-LengthFeed,-4.8 do
			WMove(Feed10,x_axis,i,feed_speed)
			if 	 Feed[count_up] then			
					Show(Feed[count_up])
			end
			count_up=math.min(count_up+1,9)
			end
			Show(Feed10)
			WMove(Feed10,x_axis,-LengthFeed,feed_speed)
		endtime=Spring.GetGameFrame()

			hideT(Feed)
		else


		 
		end 
	end
 return SignalNumber+1 
 end


 
function InnerCircleDeploy (SignalNumber,boolReverse) 
  	boolDirection= false 
	if boolReverse then boolDirection =boolReverse end
	--if the animation should be aborted, we revert it 
	if SignalTable[SignalNumber]==false then boolDirection=true end

	radialSpeed= 2*PI*0.1 *(1/1.1666 )
	
	hideT(InnerLoop)
	
		if boolDirection==true then

			for inner=1,10,1 do
				Show(InnerLoop[inner])
				Turn(InLoopCenter,y_axis,math.rad(inner*-36 ),radialSpeed)
				WaitForTurn(InLoopCenter,y_axis)
				if InnerLoop[inner-3] then
					Hide(InnerLoop[inner-3])
				end
				if i==4 then
				return SignalNumber+1 
				end
				end
			
		else
		end 

 return SignalNumber+1 
 end
 
function InnerCircleLoop (SignalNumber,boolReverse) 
  	boolDirection= false ; 	if boolReverse then boolDirection =boolReverse end
		SignalTable[SignalNumber]=true
	
	
	anteil_feed= 10
	radialSpeed=2*PI*0.10 *(1/1.1666 )

	inner=1
 	while SignalTable[SignalNumber]==true do
	
		if boolDirection==true then
	

			
				Show(InnerLoop[inner])
				Turn(InLoopCenter,y_axis,math.rad(inner*-36 ),radialSpeed)
				
				WaitForTurn(InLoopCenter,y_axis)
				offSet= ((inner+6)%10) +1
				
				
					Hide(InnerLoop[offSet] )
			
				inner=inner%10+1
		
				
		
		else
		end 
	end
 return SignalNumber+1 
 end
 

 
function OuterCircleDeploy (SignalNumber,boolReverse) 
  	boolDirection= false 
	if boolReverse then boolDirection =boolReverse end
	--if the animation should be aborted, we revert it 
	if SignalTable[SignalNumber]==false then boolDirection=true end
	--12
	out_radialSpeed= 2*PI*0.08333333333333333333 *(1/1.1666 )
	
	hideT(OuterLoopTable)
	
		if boolDirection==true then
	Turn(BigLCenter,y_axis,math.rad(-5),0)
	WaitForTurn(BigLCenter,y_axis)
			for out=1,12,1 do
			
				temp=((out+1)%12)+1			
				Show(OuterLoopTable[temp])
				Turn(BigLCenter,y_axis,math.rad(out*-30 +25),out_radialSpeed)
				WaitForTurn(BigLCenter,y_axis)
				
				if OuterLoopTable[out-7] then
					Hide(OuterLoopTable[out-7])
				 return SignalNumber+1 
				end
			end
				
		
		else
		end 

 return SignalNumber+1 

 end

UpGoTurn1=piece"UpGoTurn1"
UpGoTurn2=piece"UpGoTurn2"


 
 function OuterCircleLoop (SignalNumber,boolReverse) 
  	boolDirection= false ; 	if boolReverse then boolDirection =boolReverse end
		SignalTable[SignalNumber]=true
	
	
	Show(UpGo1)
	Show(UpGo2)
	
	
	out_radialSpeed= 2*PI*0.08333333333333333333 *(1/1.1666 )

	out=8
	Show(OuterLoopTable[6])
	Show(OuterLoopTable[7])
	Show(OuterLoopTable[8])
	Show(OuterLoopTable[9])
	Show(OuterLoopTable[10])
	Turn(BigLCenter,y_axis,math.rad(-215),0,true)
	WaitForTurn(BigLCenter,y_axis)

 	while SignalTable[SignalNumber]==true do
	
		if boolDirection==true then
	
				
			temp=((out+1)%12)+1
			
			
				Show(OuterLoopTable[temp])
				Turn(BigLCenter,y_axis,math.rad(out*-30 +25),radialSpeed)
				
				WaitForTurn(BigLCenter,y_axis)
				offSet= ((out+5)%12) +1
				
				
					Hide(OuterLoopTable[offSet] )
				if out== 4 then-- activate the upgoer
				SignalTable[SignalNumber-1]=true
				end
				
				out=out%12+1
			
			
		
		else
		end 
	end

 return SignalNumber+2 
 end
 
 function GoUp(SignalNumber,boolReverse,radialSpeed)
		boolDirection= false ; 	if boolReverse then boolDirection =boolReverse end
		SignalTable[SignalNumber]=false
		
	while SignalTable[SignalNumber]==false do
	Sleep(5)
	end	
		
 
		if boolDirection==true then
	
			while SignalTable[SignalNumber]==true do
			Hide(UpGo1)
			Hide(UpGo2)	
			Turn(UpGoTurn2,y_axis,math.rad(30),0)
			Turn(UpGoTurn1,y_axis,math.rad(60),0)	
			
			Turn(UpGo2,x_axis,math.rad(0),0,true)	
			Turn(UpGo1,x_axis,math.rad(-20),0,true)
			
			WaitForTurn(UpGoTurn1,y_axis)
			WaitForTurn(UpGoTurn2,y_axis)
			WaitForTurn(UpGo2,x_axis)
			WaitForTurn(UpGo1,x_axis)
			Show(UpGo1)
			Show(UpGo2)	
			Turn(UpGoTurn2,y_axis,math.rad(0),radialSpeed)
			Turn(UpGoTurn1,y_axis,math.rad(30),radialSpeed)
			
			Turn(UpGo2,x_axis,math.rad(-20),0.35)	
			Turn(UpGo1,x_axis,math.rad(0),0.35)	
			WaitForTurn(UpGoTurn1,y_axis)
			WaitForTurn(UpGoTurn2,y_axis)
			end
		
		else
		end 
		
	end
	

 
function UpperCircleDeploy (SignalNumber,boolReverse) 
  	boolDirection= false 
	if boolReverse then boolDirection =boolReverse end
	--if the animation should be aborted, we revert it 
	if SignalTable[SignalNumber]==false then boolDirection=true end
	--12
	out_radialSpeed= 2*PI*0.08333333333333333333 *(1/1.1666 )
	

		if boolDirection==true then
	Turn(BigLUpCenter,y_axis,math.rad(-5),0)
	WaitForTurn(BigLUpCenter,y_axis)
			for out=12,24,1 do
			
				temp=((out+1)%24)+12			
				Show(OuterLoopTable[temp])
				Turn(BigLUpCenter,y_axis,math.rad(out*-30 +25),out_radialSpeed)
				WaitForTurn(BigLUpCenter,y_axis)
				
				if OuterLoopTable[out+12-7] then
					Hide(OuterLoopTable[out+12-7])
				 return SignalNumber+1 
				end
			end
				
		
		else
		end 

 return SignalNumber+1 

 end

UpGoTurn1=piece"UpGoTurn1"
UpGoTurn2=piece"UpGoTurn2"


 
 function UpperCircleLoop (SignalNumber,boolReverse) 
  	boolDirection= false ; 	if boolReverse then boolDirection =boolReverse end
		SignalTable[SignalNumber]=true
	

	
	
	out_radialSpeed= 2*PI*0.08333333333333333333 *(1/1.1666 )

	out=20

	Turn(BigLUpCenter,y_axis,math.rad(-215),0,true)
	WaitForTurn(BigLUpCenter,y_axis)

 	while SignalTable[SignalNumber]==true do
	
		if boolDirection==true then
	
				
			temp=((out+1)%24)+12
			
			
				Show(OuterLoopTable[temp])
				Turn(BigLUpCenter,y_axis,math.rad(out*-30 +25),radialSpeed)
				
				WaitForTurn(BigLUpCenter,y_axis)
				offSet= ((out+5)%24) +12
				
				
					Hide(OuterLoopTable[offSet] )
			
				out=out%24+12
			
			
		
		else
		end 
	end

 return SignalNumber+2 
 end
	
	
 

function 	TowerDeploy(SignalNumber,boolReverse) 
 
 return SignalNumber+1 
 end
function 	OutPostDeploy(SignalNumber,boolReverse) 
 
 return SignalNumber+1 
 end
function 	InnerCityDeploy(SignalNumber,boolReverse) 
 
 return SignalNumber+1 
 end
function 	RailGunUnfold(SignalNumber,boolReverse) 
 
 return SignalNumber+1 
 end
function 	CityBlocksDeploy	(SignalNumber,boolReverse) 
 
 return SignalNumber+1 
 end

function watchForImpact()
	while GG.FiringGateFotressTable[teamid][unitID]==true do
	Sleep(250)
	end
boolOnTheMove=true
foldAnimation()	
Spring.DstroyUnit(unitID,true,false)
end



function script.Activate()

return 1
end

function script.Deactivate()

return 0
end



